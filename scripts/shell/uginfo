#!/bin/bash
######################################################################
# ugsubmit 0.1
#-------------------------------------------------------------------
# created by Martin Rupp 05.03.2012
######################################################################

echo "uginfo 0.1. (c) Goethe-Center for Scientific Computing 2012"

function usage 
{
	echo ""
    exit 0;
}

while [ $# -gt 0 ]
do
	if [ $1 = "-cluster" ]; then
		UGSUBMIT_TYPE=$2
		shift 2
	else
		break
	fi
done

if [ -z "$UGSUBMIT_TYPE" ]; then
   	echo "please set UGSUBMIT_TYPE or specify cluster with -cluster".
   	exit
fi	 
######################################################################
#        qsub on NecNehalem / NEC Nehalem Cluster / HLRS
#-------------------------------------------------------------------
######################################################################
if [ $UGSUBMIT_TYPE = "NecNehalem" ]; then
	echo "Using qsub on NecNehalem / NEC Nehalem Cluster / HLRS"
echo "Using NecNehalem"
qstat | sed -n 1p
qstat | grep $USER	

######################################################################
#                     qsub on Hermit / HLRS
#-------------------------------------------------------------------
######################################################################
elif [ $UGSUBMIT_TYPE = "Hermit" ]; then
echo "Using Hermit"
squeueOutput=`mktemp -u squeueOutputXXX`
qstat > $squeueOutput
cat $squeueOutput | sed -n 1p
cat $squeueOutput | grep $USER
rm $squeueOutput

######################################################################
#                            Jugene
#-------------------------------------------------------------------
# http://www.lrz.de/services/compute/supermuc/loadleveler/
######################################################################
elif [ $UGSUBMIT_TYPE = "Jugene" ]; then
echo "Using Jugene"

######################################################################
#                            mpi
#-------------------------------------------------------------------
# not a real job scheduler, just for completeness and tests
######################################################################
elif [ $UGSUBMIT_TYPE = "mpi" ]; then
echo "Using MPI"
ps aux | sed -n 1p
ps aux | grep $USER | grep mpirun

######################################################################
#                           cekon
#-------------------------------------------------------------------
# using SLURM
######################################################################
elif [ $UGSUBMIT_TYPE = "cekon" ]; then
echo "Using SLURM on cekon"
squeueOutput=`mktemp -u squeueOutputXXX`
squeue > $squeueOutput
cat $squeueOutput | sed -n 1p
cat $squeueOutput | grep $USER
rm $squeueOutput

######################################################################
else
	echo "" 
	echo "ERROR: cluster "$UGSUBMIT_TYPE" is not supported."
fi



