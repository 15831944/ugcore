(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     12354,        254]
NotebookOptionsPosition[     12095,        240]
NotebookOutlinePosition[     12453,        256]
CellTagsIndexPosition[     12410,        253]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"maxOrder", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"precision", " ", "=", " ", "38"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Close", "[", "str", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"str", " ", "=", " ", 
   RowBox[{"OpenWrite", "[", "\"\<~/Desktop/gauss_legendre03.h\>\"", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "str", ",", " ", "\[IndentingNewLine]", 
    "\"\<#include \\\"gauss_legendre.h\\\"\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<#include \\\"../quadrature.h\\\"\\n\>\"", ",",
     "\[IndentingNewLine]", 
    "\"\<#include \\\"common/util/provider.h\\\"\\n\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<namespace ug\\n{\\n\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    "\"\<GaussLegendre::GaussLegendre(size_t order)\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<{\\n\\n\>\"", ",", "\[IndentingNewLine]", 
    "\"\<\\tif (order % 2 == 0) order = order + 1;\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<\\tm_order = order;\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<\\tm_numPoints = (order+1)/2;\\n\>\"", ",", 
    "\[IndentingNewLine]", 
    "\"\<\\tposition_type* pvPoint= new position_type[m_numPoints];\\n\>\"", 
    ",", "\[IndentingNewLine]", 
    "\"\<\\tweight_type* pvWeight= new weight_type[m_numPoints];\\n\>\"", ",",
     "\[IndentingNewLine]", "\"\<\\tm_pvPoint = pvPoint;\\n\>\"", ",", 
    "\[IndentingNewLine]", "\"\<\\tm_pvWeight = pvWeight;\\n\\n\>\""}], 
   "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"str", ",", " ", "\"\<\\tswitch(m_numPoints)\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"str", ",", " ", "\"\<\\t{\\n\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"n", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"n", "\[LessEqual]", " ", "maxOrder"}], ",", 
   RowBox[{"n", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{
     "str", ",", " ", "\"\<\\t\\tcase \>\"", ",", " ", "n", ",", " ", 
      "\"\<:\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", " ", 
      RowBox[{"i", " ", "<=", " ", "n"}], ",", " ", 
      RowBox[{"i", "++"}], ",", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"F", "[", "x_", "]"}], " ", ":=", " ", 
        RowBox[{"LegendreP", "[", 
         RowBox[{"n", ",", "x"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"NullStellen", " ", "=", " ", 
        RowBox[{"x", "/.", 
         RowBox[{"Solve", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"F", "[", "x", "]"}], " ", "\[Equal]", " ", "0"}], ",", 
           " ", "x"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{"str", ",", "\"\<\\t\\t\\tpvPoint[\>\"", ",", 
         RowBox[{"i", "-", "1"}], ",", "\"\<][0] = \>\"", ",", " ", 
         RowBox[{"Re", "[", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"1", "/", "2"}], "*", 
              RowBox[{"NullStellen", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], "+", 
             RowBox[{"1", "/", "2"}]}], ",", "precision"}], "]"}], "]"}], ",",
          " ", "\"\<;\\n\>\""}], 
        StyleBox[" ", "Subsubsection"], 
        StyleBox["]", "Subsubsection"]}], 
       StyleBox[";", "Subsubsection"]}]}], 
     StyleBox["\[IndentingNewLine]", "Subsubsection"], 
     StyleBox["]", "Subsection"]}], 
    StyleBox[";", "Subsubsection"], 
    StyleBox["\[IndentingNewLine]", "Subsubsection"], 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", " ", 
       RowBox[{"j", " ", "<=", " ", "n"}], ",", " ", 
       RowBox[{"j", "++"}], ",", " ", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "/", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Re", "[", 
                    RowBox[{"NullStellen", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "^", "2"}], 
                   ")"}]}], ")"}], "*", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"F", "'"}], "[", 
                   RowBox[{"Re", "[", 
                    RowBox[{"NullStellen", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "^", "2"}], 
                 ")"}]}], ")"}]}], "/", "2"}], ")"}], ",", "precision"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"WriteString", "[", 
         RowBox[{"str", ",", "\"\<\\t\\t\\tpvWeight[\>\"", ",", 
          RowBox[{"j", "-", "1"}], ",", "\"\<] = \>\"", ",", " ", "res", ",", 
          " ", "\"\<;\\n\>\""}], 
         StyleBox[" ", "Subsubsection"], 
         StyleBox["]", "Subsubsection"]}], 
        StyleBox[";", "Subsubsection"]}]}], "\[IndentingNewLine]", 
      StyleBox["]", "Subsubsection"]}], 
     StyleBox["\[IndentingNewLine]", "Subsubsection"], 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", " ", "\"\<\\t\\tbreak;\\n\>\""}], "]"}]}], ";"}]}], 
  
  StyleBox["\[IndentingNewLine]", "Subsubsection"], 
  StyleBox["]", "Subsubsection"]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "str", ",", " ", "\"\<\\t\\tdefault:\\n\>\"", ",", "\n", "      ", 
    "\"\<\\t\\t\\tUG_THROW\>\"", ",", "\"\<(\>\"", ",", "\"\<\\\"\>\"", ",", 
    "\"\<GaussLegendre: Rule for order\>\"", ",", "\"\< \\\"<<\>\"", ",", 
    " ", "\"\<order\>\"", ",", "\"\<<<\\\"\>\"", ",", 
    "\"\< not supported.\\\");\>\"", ",", "\"\<\\n\\t}\>\"", ",", 
    "\"\<\\n}\\n\\n\>\""}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"WriteString", "[", 
    RowBox[{
    "str", ",", " ", "\"\<\\nGaussLegendre::~GaussLegendre()\\n{\\n\>\"", ",",
      "\[IndentingNewLine]", "\t", "\"\<\\tdelete[] m_pvPoint;\\n\>\"", ",", 
     "\[IndentingNewLine]", "\t", "\"\<\\tdelete[] m_pvWeight;\\n\>\"", ",", 
     "\[IndentingNewLine]", "\t", "\"\<};\\n\>\"", ",", 
     "\[IndentingNewLine]", "\"\<}\>\""}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.572172686559855*^9, 3.572172769509063*^9}, {
   3.572172805748171*^9, 3.5721728113878727`*^9}, {3.5721729059862957`*^9, 
   3.57217292246523*^9}, {3.572172968471987*^9, 3.572173070750184*^9}, {
   3.572173123550576*^9, 3.572173229378704*^9}, {3.572173699968602*^9, 
   3.572173711198069*^9}, {3.572173747526238*^9, 3.5721738208753557`*^9}, {
   3.572173883818*^9, 3.572173942065624*^9}, {3.5721739911200657`*^9, 
   3.572174082424419*^9}, {3.572174115473535*^9, 3.572174171993326*^9}, {
   3.572174210438095*^9, 3.572174264317049*^9}, {3.572174338404941*^9, 
   3.572174396306429*^9}, {3.572174456651367*^9, 3.57217453189151*^9}, {
   3.57217457022886*^9, 3.572174621708041*^9}, {3.572174688891176*^9, 
   3.572174818623617*^9}, {3.572174851782009*^9, 3.572175033466627*^9}, {
   3.572175131557769*^9, 3.572175139928707*^9}, {3.572175180175036*^9, 
   3.572175229911253*^9}, {3.572175317413756*^9, 3.572175402153605*^9}, {
   3.5721754424190483`*^9, 3.5721755014791327`*^9}, {3.572175618487306*^9, 
   3.572175623435854*^9}, {3.572175683340526*^9, 3.5721756836263437`*^9}, {
   3.5721757187078123`*^9, 3.572175729145171*^9}, {3.57217576108994*^9, 
   3.572175806143374*^9}, {3.5721759465580053`*^9, 3.572175947539844*^9}, {
   3.5721760152683477`*^9, 3.5721760747044373`*^9}, {3.572176107335582*^9, 
   3.572176136982655*^9}, {3.572176211525135*^9, 3.572176259947782*^9}, {
   3.5721763147084703`*^9, 3.5721763960767307`*^9}, {3.572176450767479*^9, 
   3.572176583221806*^9}, {3.5721766210060177`*^9, 3.572176674031672*^9}, {
   3.572176965280901*^9, 3.5721769655118647`*^9}, {3.572177276455348*^9, 
   3.572177338298366*^9}, {3.5721773846741734`*^9, 3.572177403928688*^9}, {
   3.5721774343289623`*^9, 3.572177469270802*^9}, {3.5721777609921303`*^9, 
   3.5721777672790422`*^9}, {3.572177928588273*^9, 3.57217792906306*^9}, {
   3.572178070609289*^9, 3.5721780989857197`*^9}, {3.572178137255021*^9, 
   3.572178184366222*^9}, {3.5721782283173857`*^9, 3.572178229196493*^9}, {
   3.5721782609566402`*^9, 3.5721783476089354`*^9}, {3.572178380424567*^9, 
   3.572178387527713*^9}, 3.57217841787195*^9, {3.5721784760380707`*^9, 
   3.572178522380516*^9}, 3.572178553171588*^9, {3.5721785909964447`*^9, 
   3.572178609169269*^9}, {3.5721789927539454`*^9, 3.572178993019669*^9}, {
   3.5722387445341*^9, 3.5722387448929567`*^9}, {3.572239093033584*^9, 
   3.572239141878242*^9}, {3.572239188180481*^9, 3.572239229214897*^9}, {
   3.5722392702036257`*^9, 3.572239296373255*^9}, {3.572239554211174*^9, 
   3.572239604537023*^9}, {3.5722396533767023`*^9, 3.572239658439432*^9}, {
   3.572239843963923*^9, 3.572239889001336*^9}, {3.5722399255695343`*^9, 
   3.572239925984683*^9}, {3.57223997648158*^9, 3.572239984878788*^9}, {
   3.572240084486515*^9, 3.572240141452813*^9}, {3.572240173563739*^9, 
   3.572240173786396*^9}, {3.572240257281143*^9, 3.5722402576799707`*^9}, {
   3.572240292145667*^9, 3.572240329189825*^9}, 3.572240420764386*^9, {
   3.572240581721149*^9, 3.5722405861480722`*^9}, {3.572240641134912*^9, 
   3.5722406947963543`*^9}, {3.57224075258003*^9, 3.572240798261533*^9}, {
   3.5722408463524923`*^9, 3.572240876759614*^9}, {3.572241016821135*^9, 
   3.5722410720020943`*^9}, {3.572241113400968*^9, 3.5722411382963037`*^9}, {
   3.572241240559251*^9, 3.572241356483177*^9}, {3.5722414016271267`*^9, 
   3.572241452545034*^9}, {3.572241482911542*^9, 3.5722415425333157`*^9}, {
   3.5722415824612837`*^9, 3.572241620883505*^9}, {3.5722416684759827`*^9, 
   3.5722416688982*^9}, {3.57224179191199*^9, 3.572241795134883*^9}, 
   3.5722419105897284`*^9, {3.5722420027465677`*^9, 3.5722420238962727`*^9}, {
   3.572242130182074*^9, 3.5722421549174557`*^9}, {3.572242207913342*^9, 
   3.572242211700673*^9}, {3.5722422470606194`*^9, 3.572242300369392*^9}, {
   3.5722424432785263`*^9, 3.5722424883735847`*^9}, {3.5722427204575367`*^9, 
   3.5722427466538754`*^9}, {3.572242911692182*^9, 3.5722429174731073`*^9}, {
   3.5722431118047647`*^9, 3.57224317278607*^9}, {3.572243232009439*^9, 
   3.572243316975548*^9}, {3.5722434282192698`*^9, 3.5722435076249657`*^9}, {
   3.572243573569908*^9, 3.572243575595738*^9}, {3.572244359707466*^9, 
   3.572244449890176*^9}, {3.572244482096478*^9, 3.572244675834675*^9}, {
   3.572244726860127*^9, 3.572244822775741*^9}, 3.572244934533008*^9, {
   3.572245078993202*^9, 3.572245079159968*^9}, {3.5722451673428593`*^9, 
   3.572245284114953*^9}, {3.5722453328897667`*^9, 3.572245349217304*^9}, {
   3.572245439032694*^9, 3.5722454904774523`*^9}, {3.572245526729107*^9, 
   3.5722455527242727`*^9}, {3.5722456035317907`*^9, 3.572245616610579*^9}, {
   3.572246720687552*^9, 3.57224674472279*^9}, {3.572762751805538*^9, 
   3.5727627525072517`*^9}, {3.572762813901596*^9, 3.572762828240397*^9}, 
   3.572776455902308*^9, {3.573191448266055*^9, 3.573191456760027*^9}}]
},
WindowSize->{1254, 1181},
WindowMargins->{{21, Automatic}, {Automatic, 55}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (November 6, \
2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 11534, 218, 690, "Input"]
}
]
*)

(* End of internal cache information *)
